<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="description" content="Computational Physics and Quantum Mechanical Systems">

<title>Computational Physics and Quantum Mechanical Systems</title>


<style type="text/css">
/* bloodish style */

body {
  font-family: Helvetica, Verdana, Arial, Sans-serif;
  color: #404040;
  background: #ffffff;
}
h1 { font-size: 1.8em;  color: #8A0808; }
h2 { font-size: 1.6em;  color: #8A0808; }
h3 { font-size: 1.4em;  color: #8A0808; }
h4 { color: #8A0808; }
a { color: #8A0808; text-decoration:none; }
tt { font-family: "Courier New", Courier; }
/* pre style removed because it will interfer with pygments */
p { text-indent: 0px; }
hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
p.caption { width: 80%; font-style: normal; text-align: left; }
hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}
.alert-text-small   { font-size: 80%;  }
.alert-text-large   { font-size: 130%; }
.alert-text-normal  { font-size: 90%;  }
.alert {
  padding:8px 35px 8px 14px; margin-bottom:18px;
  text-shadow:0 1px 0 rgba(255,255,255,0.5);
  border:1px solid #bababa;
  border-radius: 4px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  color: #555;
  background-color: #f8f8f8;
  background-position: 10px 5px;
  background-repeat: no-repeat;
  background-size: 38px;
  padding-left: 55px;
  width: 75%;
 }
.alert-block {padding-top:14px; padding-bottom:14px}
.alert-block > p, .alert-block > ul {margin-bottom:1em}
.alert li {margin-top: 1em}
.alert-block p+p {margin-top:5px}
.alert-notice { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_gray_notice.png); }
.alert-summary  { background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_gray_summary.png); }
.alert-warning { background-image: url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_gray_warning.png); }
.alert-question {background-image:url(https://cdn.rawgit.com/hplgit/doconce/master/bundled/html_images/small_gray_question.png); }

div { text-align: justify; text-justify: inter-word; }
</style>


<script src="http://sagecell.sagemath.org/static/jquery.min.js"></script>
<script src="http://sagecell.sagemath.org/embedded_sagecell.js"></script>
<link rel="stylesheet" type="text/css" href="https://sagecell.sagemath.org/static/sagecell_embed.css">
<script>
$(function () {
    // Make the div with id 'mycell' a Sage cell
    sagecell.makeSagecell({inputLocation:  '#mycell',
                           template:       sagecell.templates.minimal,
                           evalButtonText: 'Activate'});
    // Make *any* div with class 'compute' a Sage cell
    sagecell.makeSagecell({inputLocation: 'div.compute',
                           evalButtonText: 'Evaluate'});
});
</script>

</head>

<!-- tocinfo
{'highest level': 2,
 'sections': [('Topics covered in this course', 2, None, '___sec0'),
              ('Overarching aims of this course, how to develop and finalize a numerical project',
               2,
               None,
               '___sec1'),
              ('Learning outcomes', 2, None, '___sec2'),
              ('Why is computing competence important?', 2, None, '___sec3'),
              ('Computing competence, what is it?', 2, None, '___sec4'),
              ('What is computing competence about?', 2, None, '___sec5'),
              ('Continuous verse discrete', 2, None, '___sec6'),
              ('Shift from classical mathematics to modern computing',
               2,
               None,
               '___sec7'),
              ('Key principle in scientific modeling', 2, None, '___sec8'),
              ('Computing competence is central to solving scientific problems',
               2,
               None,
               '___sec9'),
              ('Modeling and computations', 2, None, '___sec10'),
              ('Symbolic calculations and numerical calculations in one code',
               2,
               None,
               '___sec11'),
              ('Error analysis', 2, None, '___sec12'),
              ('Integrating numerical mathematics with calculus',
               2,
               None,
               '___sec13'),
              ('Additional benefits: A structured approach to solving problems',
               2,
               None,
               '___sec14'),
              ('Additional benefits: A structure approach to solving problems',
               2,
               None,
               '___sec15'),
              ('Literature', 2, None, '___sec16'),
              ('Installing C++ and Fortran', 2, None, '___sec17'),
              ('Installing and running python', 2, None, '___sec18'),
              ('Optimization and profiling', 2, None, '___sec19'),
              ('More on optimization', 2, None, '___sec20'),
              ('Optimization and profiling', 2, None, '___sec21'),
              ('Optimization and debugging', 2, None, '___sec22'),
              ('How do I run MPI on a PC/Laptop? MPI', 2, None, '___sec23'),
              ('Can I do it on my own PC/laptop? OpenMP installation',
               2,
               None,
               '___sec24'),
              ('Installing MPI', 2, None, '___sec25'),
              ('Installing MPI and using Qt', 2, None, '___sec26'),
              ('Matrix Handling in C/C++ and Fortran, Static and Dynamical allocation',
               2,
               None,
               '___sec27'),
              ('Matrix Handling in C/C++', 2, None, '___sec28'),
              ('Matrix Handling in C/C++', 2, None, '___sec29'),
              ('Matrix Handling in Fortran 90/95, dynamic allocation and deallocation',
               2,
               None,
               '___sec30'),
              ('Dynamic memory allocation in C/C++', 2, None, '___sec31'),
              ('Matrix Handling in C/C++, Dynamic Allocation',
               2,
               None,
               '___sec32'),
              ('Armadillo, recommended!!', 2, None, '___sec33'),
              ('Armadillo, simple examples', 2, None, '___sec34'),
              ('Armadillo, how to compile and install', 2, None, '___sec35'),
              ('Armadillo, simple examples', 2, None, '___sec36'),
              ('Armadillo, simple examples', 2, None, '___sec37'),
              ('Armadillo, simple examples', 2, None, '___sec38'),
              ('Armadillo, simple examples', 2, None, '___sec39'),
              ('Armadillo, simple examples', 2, None, '___sec40'),
              ('Armadillo, simple examples', 2, None, '___sec41'),
              ('Armadillo, simple examples', 2, None, '___sec42')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "AMS"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    
<!-- ------------------- main content ---------------------- -->



<center><h1>Computational Physics and Quantum Mechanical Systems</h1></center>  <!-- document title -->

<p>
<!-- author(s): Morten Hjorth-Jensen -->

<center>
<b>Morten Hjorth-Jensen</b> [1, 2]
</center>

<p>
<!-- institution(s) -->

<center>[1] <b>Department of Physics, University of Oslo, Norway</b></center>
<center>[2] <b>Department of Physics and Astronomy and National Superconducting Cyclotron Laboratory, Michigan State University, USA</b></center>
<br>
<p>
<center><h4>May 16-20, 2016</h4></center> <!-- date -->
<br>
<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec0">Topics covered in this course </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
This course aims at giving you an overview of important numerical methods for solving quantum mechanical problems. In particular, in this course we will focus on

<ul>
  <li> Quantum Monte Carlo methods applied to few-electron systems like <a href="https://journals.aps.org/rmp/abstract/10.1103/RevModPhys.74.1283" target="_blank">quantum dots</a>, electrons confined to move in two or three dimensions. The system we will study will contain up to 20 interacting electrons in an oscillator trap.</li> 
  <li> Linear algebra and eigenvalue problems with applications to the same physical systems, simple two-electron systems and Hartree-Fock theory.</li>
  <li> Object orientation, code optimization and High-performance computing aspects</li> 
</ul>

The main programming language will be c++ (and Fortran), with Python examples in the slides.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec1">Overarching aims of this course, how to develop and finalize a numerical project </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
While developing the mathematical tools and a numerical project we aim at giving you an
insight in how to:

<ul>
  <li> Develop a critical approach to all steps in a project, which methods are most relevant, which natural laws and physical processes are important. Sort out initial conditions and boundary conditions etc.</li>
  <li> To teach you structured scientific computing and learn to structure a project using for example object orientation.</li>
  <li> To give you a critical understanding of central mathematical algorithms and methods from numerical analysis. In particular their limits and stability criteria.</li>
  <li> To show you how to use version control software to keep track of different versions of your normal project, how to verify and validate your codes and how to make your science reproducible. We will demonstrate this using <a href="https://git-scm.com/" target="_blank">git</a> and <a href="https://github.com" target="_blank">github</a></li>
</ul>
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec2">Learning outcomes </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
We hope we can give you some useful hints and guidance on

<ul>
 <li> how to develop a thorough understanding of how computing is used to solve scientific problems</li>
 <li> getting to know some central  algorithms used in science</li>
 <li> developing knowledge of high-performance computing elements: memory usage, vectorization and parallel algorithms</li>
 <li> understanding approximation errors and what can go wrong with algorithms</li>
 <li> getting experience with programming in a compiled language (Fortran, C, C++)</li>
 <li> getting experience with test frameworks and procedures</li>
 <li> being able to  critically evaluate results and errors</li>
 <li> understanding how to increase the efficiency of numerical algorithms and pertinent software</li>
 <li> understanding tools to make science reproducible and to develop a sound ethical approach to scientific problems</li>
</ul>
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec3">Why is computing competence important? </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b>Definition of computing.</b>
<p>
With computing I will mean solving scientific problems using computers. It covers numerical, analytical as well as symbolic computing. Computing is also about developing an understanding of the scientific process by enhancing algorithmic thinking when solving problems.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec4">Computing competence, what is it? </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Computing competence has always been a central part of the science and engineering education. Traditionally, such competence meant mastering mathematical methods to solve science problems - by pen and paper.

<p>
Today you are expected to use all available tools to solve scientific problems; computers primarily, but also pen and paper.

<p>
I will use the term/word algorithms in the broad meaning:  methods (for example mathematical) to solve science problems, with and without computers.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec5">What is computing competence about?  </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Computing competence is about

<ol>
<li> derivation, verification, and implementation of algorithms</li>
<li> understanding what can go wrong with algorithms</li>
<li> overview of important, known algorithms</li>
<li> understanding how algorithms are used to solve mathematical problems</li>
<li> reproducible science and ethics</li>
<li> algorithmic thinking for gaining deeper insights about scientific problems</li>
</ol>
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec6">Continuous verse discrete </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Algorithms involving pen and paper are traditionally aimed at what we often refer to as continuous models.

<p>
Application of computers calls for approximate discrete models.

<p>
Much of the development of methods for continuous models are now being replaced by methods for discrete models in science and industry, simply because much larger problem classes can be addressed with discrete models, often also by simpler and more generic methodologies. However, verification of algorithms and understanding their limitations requires much of the classical knowledge about continuous models.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec7">Shift from classical mathematics to modern computing </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ol>
<li> The impact of the computer on mathematics is tremendous: science and industry now rely on solving mathematical problems through computing.</li>
<li> Computing increases the relevance in education by solving more realistic problems earlier.</li>
<li> Computing through programming is excellent training of creativity.</li>
<li> Computing enhances the understanding of abstractions and generalization.</li>
<li> Computing decreases the need for special tricks and tedious algebra, and shifts the focus to problem definition, visualization, and "what if" discussions.</li>
</ol>

The result is a deeper understanding of mathematical modeling. Not only is computing via programming a very powerful tool, it also a great pedagogical aid.
For the mathematical training, there is one major new component among the arguments above: understanding abstractions and generalization. While many of the classical methods developed for continuous models are specialized for a particular problem or a narrow class of problems, computing-based algorithms are often developed for problems in a generic form and hence applicable to a large problem class.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec8">Key principle in scientific modeling </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The power of the scientific method lies in identifying a given problem as a special case of an abstract class of problems, identifying general solution methods for this class of problems, and applying a general method to the specific problem (applying means, in the case of computing, calculations by pen and paper, symbolic computing, or numerical computing by ready-made and/or self-written software). This generic view on problems and methods is particularly important for understanding how to apply available, generic software to solve a particular problem.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec9">Computing competence is central to solving scientific problems </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b>Definition of computing.</b>
<p>
Computing competence represents a central element in scientific problem solving, from basic education and research to essentially almost all advanced problems in modern societies. Computing competence is simply central to further progress. It enlarges the body of tools available to students and scientists beyond classical tools and allows for a more generic handling of problems. Focusing on algorithmic aspects results in deeper insights about scientific problems.

<p>
Today's project in science and industry tend to involve larger teams. Tools for reliable collaboration must therefore be mastered (e.g., version control systems, automated computer experiments for reproducibility, software and method documentation).


</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec10">Modeling and computations </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
In this course we will try to focus on how to 

<ul>
<li> Introduce research  elements as early as possible</li>
<li> Trigger further insights in math and other disciplines</li> 
<li> Validation and verification of scientific results, with the possibility to emphasize ethical aspects as well. Version control is central.</li>
<li> Introduce good project handling  practices from day one.</li>
</ul>
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec11">Symbolic calculations and numerical calculations in one code  </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The following simple example here illustrates many of the previous points. 
Python offers an  extremely versatile programming  environment, allowing for
the inclusion of analytical studies in a numerical program. Here we show an
example code with the <b>trapezoidal rule</b> using <b>SymPy</b> to evaluate an integral and compute the absolute error
with respect to the numerically evaluated one of the integral
\( 4\int_0^1 dx/(1+x^2) = \pi \):
<p>


<div class="compute"><script type="text/x-sage">
from math import *
from sympy import *
def Trapez(a,b,f,n):
   h = (b-a)/float(n)
   s = 0
   x = a
   for i in range(1,n,1):
       x = x+h
       s = s+ f(x)
   s = 0.5*(f(a)+f(b)) +s
   return h*s

#  function to compute pi
def function(x):
    return 4.0/(1+x*x)

a = 0.0;  b = 1.0; n = 100
result = Trapez(a,b,function,n)
print "Trapezoidal rule=", result
# define x as a symbol to be used by sympy
x = Symbol('x')
exact = integrate(function(x), (x, 0.0, 1.0))
print "Sympy integration=", exact
# Find relative error
print "Relative error", abs((exact-result)/exact)

</script></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec12">Error analysis </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The following extended version of the trapezoidal rule allows you  to plot the relative error by comparing with the exact result. By increasing to \( 10^8 \) points one arrives at a region where numerical errors start to accumulate.
<p>


<div class="compute"><script type="text/x-sage">
from math import log10
import numpy as np
from sympy import Symbol, integrate
import matplotlib.pyplot as plt
# function for the trapezoidal rule
def Trapez(a,b,f,n):
   h = (b-a)/float(n)
   s = 0
   x = a
   for i in range(1,n,1):
       x = x+h
       s = s+ f(x)
   s = 0.5*(f(a)+f(b)) +s
   return h*s
#  function to compute pi
def function(x):
    return 4.0/(1+x*x)
# define integration limits
a = 0.0;  b = 1.0;
# find result from sympy
# define x as a symbol to be used by sympy
x = Symbol('x')
exact = integrate(function(x), (x, a, b))
# set up the arrays for plotting the relative error
n = np.zeros(9); y = np.zeros(9);
# find the relative error as function of integration points
for i in range(1, 8, 1):
    npts = 10**i
    result = Trapez(a,b,function,npts)
    RelativeError = abs((exact-result)/exact)
    n[i] = log10(npts); y[i] = log10(RelativeError);
plt.plot(n,y, 'ro')
plt.xlabel('n')
plt.ylabel('Relative error')
plt.show()

</script></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec13">Integrating numerical mathematics with calculus </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The last example shows the potential of combining numerical algorithms with symbolic calculations, allowing you thereby  to

<ul>
<li> Validate and verify  your  algorithms.</li> 
<li> Include concepts like unit testing. It gives you the possibility to test and validate several or all parts of the code.</li>
<li> Validation and verification are then included <em>naturally</em> and you can develop a better attitude to what is meant with an ethically sound scientific approach.</li>
<li> The above example allows you to test the mathematical error of the algorithm for the trapezoidal rule by changing the number of integration points. You get to think error analysis from day one.</li>
</ul>
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec14">Additional benefits: A structured approach to solving problems </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
In this process we easily bake in

<ol>
  <li> How to structure a code in terms of functions</li>
  <li> How to make a module</li>
  <li> How to read input data flexibly from the command line</li>
  <li> How to create graphical/web user interfaces</li>
  <li> How to write unit tests (test functions or doctests)</li>
  <li> How to refactor code in terms of classes (instead of functions only)</li>
  <li> How to conduct and automate large-scale numerical experiments</li>
  <li> How to write scientific reports in various formats (LaTeX, HTML)</li>
</ol>
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec15">Additional benefits: A structure approach to solving problems </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
The conventions and techniques outlined here will save you a lot of time when you incrementally extend software over time from simpler to more complicated problems. In particular, you will benefit from many good habits:

<ol>
<li> New code is added in a modular fashion to a library (modules)</li>
<li> Programs are run through convenient user interfaces</li>
<li> It takes one quick command to let all your code undergo heavy testing</li> 
<li> Tedious manual work with running programs is automated,</li>
<li> Your scientific investigations are reproducible, scientific reports with top quality typesetting are produced both for paper and electronic devices.</li>
</ol>
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec16">Literature </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
<li> <a href="https://github.com/CompPhysics/ComputationalPhysicsMSU/blob/master/doc/Lectures/lectures2015.pdf" target="_blank">Lecture notes on Computational Physics  by Morten Hjorth-Jensen, C++, Fortran, and Python</a></li>
<li> <a href="https://github.com/CompPhysics/ComputationalPhysicsMSU/blob/master/doc/Lectures/HPLpython.pdf" target="_blank">A Primer on Scientific Programming with Python by Hans Petter Langtangen</a></li>
</ul>
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec17">Installing C++ and Fortran </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
If you wish to use C++ or Fortran, we recommend normally 

<ul>
<li> C++: Use an Integrated Development Environment (IDE) like <a href="https://www.qt.io/ide/" target="_blank">Qt</a> which works on all platforms</li>
<li> C++: Use the IDE <a href="https://msdn.microsoft.com/en-us/library/60k1461a.aspx" target="_blank">Visual C++</a>  for Windows as operating system or <a href="https://sourceforge.net/projects/orwelldevcpp/" target="_blank">Dev C++</a>.</li>
<li> For Mac (OSX) and linux users the <a href="https://gcc.gnu.org/" target="_blank">GNU gcc and gfortran</a>  family of compilers are  widely used.</li>
<li> <a href="https://software.intel.com/en-us/blogs/2013/01/03/free-intel-c-compilers-for-students-and-related-parallel-programming-tools" target="_blank">The Intel C++ and Fortran compilers</a> are excellent. Free versions exist for students.</li> 
</ul>
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec18">Installing and running python </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<ul>
<li> For Linux and OSX users python is included by default. Check which version by typing  in a terminal window</li>
</ul>

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">python <span style="color: #666666">-</span>v 
</pre></div>
<p>
Additional packages may have to be installed. For OSX users I highly recommend installing python and additional packages using <a href="http://brew.sh/" target="_blank">brew</a>. This makes it extremely simple to add packages and install additional software. With brew there is no point for OSX users to use virtual machines. 

<ul>
<li> You can also install platform independent IDE versions like the <a href="https://www.enthought.com/products/epd/" target="_blank">Enthought Python Distribution</a> or <a href="https://www.continuum.io/downloads" target="_blank">Anaconda</a>.</li>
<li> For Windows users, you may consider a virtual machine like <a href="https://my.vmware.com/group/vmware/details?productId=154&downloadGroup=WKST-716-WIN" target="_blank">VMware Ubuntu</a></li> 
<li> You can also go directly to the <a href="https://www.python.org/downloads/" target="_blank">python website</a> and download the Windows version.</li> 
</ul>

If you want to run a python program in terminal mode, simply write
<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">python nameofprog.py 
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec19">Optimization and profiling </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>

<p>
If you use C++ or Fortran without an IDE, you would compile as
<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">c<span style="color: #666666">++</span>  <span style="color: #666666">-</span>c  mycode.cpp
c<span style="color: #666666">++</span>  <span style="color: #666666">-</span>o  mycode.exe  mycode.o
</pre></div>
<p>
For Fortran replace with for example <b>gfortran</b> or <b>ifort</b>.
This is what we call a flat compiler option and should be used when we develop the code.
It produces normally a very large and slow code when translated into machine instructions.
We use this option for debugging and for establishing the correct program output because
every operation is done precisely as the user specified it.

<p>
It is instructive to look up the compiler manual for further instructions by writing for example
<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">man c<span style="color: #666666">++</span>
</pre></div>

</div>

<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec20">More on optimization </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
We have additional compiler options for optimization. These may include procedure inlining where 
performance may be improved, moving constants inside loops outside the loop, 
identify potential parallelism, include automatic vectorization or replace a division with a reciprocal
and a multiplication if this speeds up the code.
<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">c<span style="color: #666666">++</span>  <span style="color: #666666">-</span>O3 <span style="color: #666666">-</span>c  mycode.cpp
c<span style="color: #666666">++</span>  <span style="color: #666666">-</span>O3 <span style="color: #666666">-</span>o  mycode.exe  mycode.o
</pre></div>
<p>
This (other options are -O2 or -Ofast) is the recommended option.


</div>

<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec21">Optimization and profiling  </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
It is also useful to profile your program under the development stage.
You would then compile with 
<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">c<span style="color: #666666">++</span>  <span style="color: #666666">-</span>pg <span style="color: #666666">-</span>O3 <span style="color: #666666">-</span>c  mycode.cpp
c<span style="color: #666666">++</span>  <span style="color: #666666">-</span>pg <span style="color: #666666">-</span>O3 <span style="color: #666666">-</span>o  mycode.exe  mycode.o
</pre></div>
<p>
After you have run the code you can obtain the profiling information via
<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">gprof mycode.exe <span style="color: #666666">&gt;</span>  ProfileOutput
</pre></div>
<p>
When you have profiled properly your code, you must take out this option as it 
slows down performance.
For memory tests use <a href="http://www.valgrind.org" target="_blank">valgrind</a>. An excellent environment for all these aspects, and much  more, is  <a href="https://www.qt.io/ide/" target="_blank">Qt creator</a>.


</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec22">Optimization and debugging  </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
Adding debugging options is a very useful alternative under the development stage of a program.
You would then compile with 
<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">c<span style="color: #666666">++</span>  <span style="color: #666666">-</span>g <span style="color: #666666">-</span>O0 <span style="color: #666666">-</span>c  mycode.cpp
c<span style="color: #666666">++</span>  <span style="color: #666666">-</span>g <span style="color: #666666">-</span>O0 <span style="color: #666666">-</span>o  mycode.exe  mycode.o
</pre></div>
<p>
This option generates debugging information allowing you to trace for example if an array is properly allocated. Some compilers work best with the no optimization option <b>-O0</b>.
</div>

<div class="alert alert-block alert-block alert-text-normal">
<b>Other optimization flags.</b>
<p>
Depending on the compiler, one can add flags which generate code that catches integer overflow errors. 
The flag <b>-ftrapv</b> does this for the CLANG compiler on OS X operating systems.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec23">How do I run MPI on a PC/Laptop? MPI  </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
To install MPI is rather easy on hardware running unix/linux as operating systems, follow simply the instructions from the <a href="https://www.open-mpi.org/" target="_blank">OpenMPI website</a>. See also subsequent slides.
When you have made sure you have installed MPI on your PC/laptop, 

<ul>
<li> Compile with mpicxx/mpic++ or mpif90</li>
</ul>

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">  <span style="color: #BC7A00"># Compile and link</span>
  mpic<span style="color: #666666">++</span> <span style="color: #666666">-</span>O3 <span style="color: #666666">-</span>o nameofprog.x nameofprog.cpp
  <span style="color: #BC7A00">#  run code with for example 8 processes using mpirun/mpiexec</span>
  mpiexec <span style="color: #666666">-</span>n <span style="color: #666666">8</span> .<span style="color: #666666">/</span>nameofprog.x
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec24">Can I do it on my own PC/laptop? OpenMP installation </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
If you wish to install MPI and OpenMP 
on your laptop/PC, we recommend the following:

<ul>
<li> For OpenMP, the compile option <b>-fopenmp</b> is included automatically in recent versions of the C++ compiler and Fortran compilers. For users of different Linux distributions, siply use the available C++ or Fortran compilers and add the above compiler instructions, see also code examples below.</li> 
<li> For OS X users however, use for example</li> 
</ul>

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">  brew install clang<span style="color: #666666">-</span>omp
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec25">Installing MPI </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
For linux/ubuntu users, you need to install two packages (alternatively use the synaptic package manager)
<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">  sudo apt<span style="color: #666666">-</span>get install libopenmpi<span style="color: #666666">-</span>dev
  sudo apt<span style="color: #666666">-</span>get install openmpi<span style="color: #666666">-</span>bin
</pre></div>
<p>
For OS X users, install brew (after having installed xcode and gcc, needed for the 
gfortran compiler of openmpi) and then install with brew
<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">   brew install openmpi
</pre></div>
<p>
When running an executable (code.x), run as
<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">  mpirun <span style="color: #666666">-</span>n <span style="color: #666666">10</span> .<span style="color: #666666">/</span>code.x
</pre></div>
<p>
where we indicate that we want  the number of processes to be 10.


</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec26">Installing MPI and using Qt </h2>
<div class="alert alert-block alert-block alert-text-normal">
<b></b>
<p>
With openmpi installed, when using Qt, add to your .pro file the instructions <a href="http://dragly.org/2012/03/14/developing-mpi-applications-in-qt-creator/" target="_blank">here</a>

<p>
You may need to tell Qt where openmpi is stored.


</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec27">Matrix Handling in C/C++ and Fortran, Static and Dynamical allocation </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Static.</b>
<p>
We have  an \( N\times N \) matrix A  with \( N=100 \)
In C/C++ this would be  defined as

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">   <span style="color: #B00040">int</span> N <span style="color: #666666">=</span> <span style="color: #666666">100</span>;
   <span style="color: #B00040">double</span> A[<span style="color: #666666">100</span>][<span style="color: #666666">100</span>];
   <span style="color: #408080; font-style: italic">//   initialize all elements to zero</span>
   <span style="color: #008000; font-weight: bold">for</span>(i<span style="color: #666666">=0</span> ; i <span style="color: #666666">&lt;</span> N ; i<span style="color: #666666">++</span>) {
      <span style="color: #008000; font-weight: bold">for</span>(j<span style="color: #666666">=0</span> ; j <span style="color: #666666">&lt;</span> N ; j<span style="color: #666666">++</span>) {
         A[i][j] <span style="color: #666666">=</span> <span style="color: #666666">0.0</span>;
</pre></div>
<p>
Note the way the matrix is organized, row-major order.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec28">Matrix Handling in C/C++ </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Row Major Order, Addition.</b>
<p>
We have  \( N\times N \) matrices A, B and C and we wish to
evaluate \( A=B+C \).

$$
\mathbf{A}= \mathbf{B}\pm\mathbf{C}  \Longrightarrow a_{ij} = b_{ij}\pm c_{ij},
$$

In C/C++ this would be coded like

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">   <span style="color: #008000; font-weight: bold">for</span>(i<span style="color: #666666">=0</span> ; i <span style="color: #666666">&lt;</span> N ; i<span style="color: #666666">++</span>) {
      <span style="color: #008000; font-weight: bold">for</span>(j<span style="color: #666666">=0</span> ; j <span style="color: #666666">&lt;</span> N ; j<span style="color: #666666">++</span>) {
         a[i][j] <span style="color: #666666">=</span> b[i][j]<span style="color: #666666">+</span>c[i][j]
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec29">Matrix Handling in C/C++ </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Row Major Order, Multiplication.</b>
<p>
We have  \( N\times N \) matrices A, B and C and we wish to
evaluate \( A=BC \).

$$
\mathbf{A}=\mathbf{BC}   \Longrightarrow a_{ij} = \sum_{k=1}^{n} b_{ik}c_{kj},
$$

In C/C++ this would be coded like

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">   <span style="color: #008000; font-weight: bold">for</span>(i<span style="color: #666666">=0</span> ; i <span style="color: #666666">&lt;</span> N ; i<span style="color: #666666">++</span>) {
      <span style="color: #008000; font-weight: bold">for</span>(j<span style="color: #666666">=0</span> ; j <span style="color: #666666">&lt;</span> N ; j<span style="color: #666666">++</span>) {
         <span style="color: #008000; font-weight: bold">for</span>(k<span style="color: #666666">=0</span> ; k <span style="color: #666666">&lt;</span> N ; k<span style="color: #666666">++</span>) {
            a[i][j]<span style="color: #666666">+=</span>b[i][k]<span style="color: #666666">*</span>c[k][j];
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec30">Matrix Handling in Fortran 90/95, dynamic allocation and deallocation </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Column Major Order.</b>
<p>
<p>

<!-- code=fortran (!bc fcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">   <span style="color: #008000; font-weight: bold">ALLOCATE</span> (a(N,N), b(N,N), c(N,N))
   <span style="color: #008000; font-weight: bold">DO </span>j<span style="color: #666666">=1</span>,  N
      <span style="color: #008000; font-weight: bold">DO </span>i<span style="color: #666666">=1</span>, N
         a(i,j)<span style="color: #666666">=</span>b(i,j)<span style="color: #666666">+</span>c(i,j)
      ENDDO
   ENDDO
   ...
   <span style="color: #008000; font-weight: bold">DEALLOCATE</span>(a,b,c)
</pre></div>
<p>
Fortran 90 writes the above statements in a much simpler way

<p>

<!-- code=fortran (!bc fcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">   a<span style="color: #666666">=</span>b<span style="color: #666666">+</span>c
</pre></div>
<p>
Multiplication

<p>

<!-- code=fortran (!bc fcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">   a<span style="color: #666666">=</span><span style="color: #008000">MATMUL</span>(b,c)
</pre></div>
<p>
Fortran contains also the intrinsic functions TRANSPOSE and CONJUGATE.
</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec31">Dynamic memory allocation in C/C++ </h2>

<p>
At least three possibilities in this course

<ul>
<li> Do it yourself with plain C/C++ functions like <b>new</b> and <b>delete</b>.</li> 
<li> Use the functions provided in the <a href="https://github.com/CompPhysics/ComputationalPhysicsMSU/tree/master/doc/Programs/LecturePrograms/programs" target="_blank">library package lib.cpp</a></li>
<li> Use Armadillo <a href="http://arma.sourceforgenet" target="_blank"><tt>http://arma.sourceforgenet</tt></a> (a C++ linear algebra library, discussion next two weeks, both here and at lab).</li> 
<li> Write your own vector-matrix class or use the examples in the <a href="https://github.com/CompPhysics/ComputationalPhysicsMSU/tree/master/doc/Programs/CppQtCodesLectures/VectorClass" target="_blank">program folder</a></li>
</ul>

<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec32">Matrix Handling in C/C++, Dynamic Allocation </h2>

<p>
<div class="alert alert-block alert-block alert-text-normal">
<b>Do it yourself.</b>
<p>
<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #B00040">int</span> N;
<span style="color: #B00040">double</span> <span style="color: #666666">**</span>  A;
A <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> <span style="color: #B00040">double</span><span style="color: #666666">*</span>[N]
<span style="color: #008000; font-weight: bold">for</span> ( i <span style="color: #666666">=</span> <span style="color: #666666">0</span>; i <span style="color: #666666">&lt;</span> N; i<span style="color: #666666">++</span>)
    A[i] <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> <span style="color: #B00040">double</span>[N];
</pre></div>
<p>
Always free space when you don't need an array anymore.

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">for</span> ( i <span style="color: #666666">=</span> <span style="color: #666666">0</span>; i <span style="color: #666666">&lt;</span> N; i<span style="color: #666666">++</span>)
    <span style="color: #008000; font-weight: bold">delete</span>[] A[i];
<span style="color: #008000; font-weight: bold">delete</span>[] A;
</pre></div>

</div>


<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec33">Armadillo, recommended!! </h2>

<ul>
  <li> Armadillo is a C++ linear algebra library (matrix maths) aiming towards a good balance between speed and ease of use. The syntax is deliberately similar to Matlab.</li>
  <li> Integer, floating point and complex numbers are supported, as well as a subset of trigonometric and statistics functions. Various matrix decompositions are provided through optional integration with LAPACK, or one of its high performance drop-in replacements (such as the multi-threaded MKL or ACML libraries).</li>
  <li> A delayed evaluation approach is employed (at compile-time) to combine several operations into one and reduce (or eliminate) the need for temporaries. This is accomplished through recursive templates and template meta-programming.</li>
  <li> Useful for conversion of research code into production environments, or if C++ has been decided as the language of choice, due to speed and/or integration capabilities.</li>
  <li> The library is open-source software, and is distributed under a license that is useful in both open-source and commercial/proprietary contexts.</li>
</ul>

<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec34">Armadillo, simple examples </h2>

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #BC7A00">#include &lt;iostream&gt;</span>
<span style="color: #BC7A00">#include &lt;armadillo&gt;</span>

<span style="color: #008000; font-weight: bold">using</span> <span style="color: #008000; font-weight: bold">namespace</span> std;
<span style="color: #008000; font-weight: bold">using</span> <span style="color: #008000; font-weight: bold">namespace</span> arma;

<span style="color: #B00040">int</span> <span style="color: #0000FF">main</span>(<span style="color: #B00040">int</span> argc, <span style="color: #B00040">char</span><span style="color: #666666">**</span> argv)
  {
  mat A <span style="color: #666666">=</span> randu<span style="color: #666666">&lt;</span>mat<span style="color: #666666">&gt;</span>(<span style="color: #666666">5</span>,<span style="color: #666666">5</span>);
  mat B <span style="color: #666666">=</span> randu<span style="color: #666666">&lt;</span>mat<span style="color: #666666">&gt;</span>(<span style="color: #666666">5</span>,<span style="color: #666666">5</span>);

  cout <span style="color: #666666">&lt;&lt;</span> A<span style="color: #666666">*</span>B <span style="color: #666666">&lt;&lt;</span> endl;

  <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">0</span>;
</pre></div>
<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec35">Armadillo, how to compile and install </h2>

<p>
For people using Ubuntu, Debian, Linux Mint, simply go to the synaptic package manager and install
armadillo from there.
You may have to install Lapack as well.
For Mac and Windows users, follow the instructions from the webpage
<a href="http://arma.sourceforge.net" target="_blank"><tt>http://arma.sourceforge.net</tt></a>. For Mac users we strongly recommend using <a href="http://brew.sh/" target="_blank">brew</a>.

<p>
To compile, use for example
<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">c<span style="color: #666666">++</span> <span style="color: #666666">-</span>O2 <span style="color: #666666">-</span>o program.x program.cpp  <span style="color: #666666">-</span>larmadillo <span style="color: #666666">-</span>llapack <span style="color: #666666">-</span>lblas
</pre></div>
<p>
where the <code>-l</code> option indicates the library you wish to link to.

<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec36">Armadillo, simple examples </h2>

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #BC7A00">#include &lt;iostream&gt;</span>
<span style="color: #BC7A00">#include &quot;armadillo&quot;</span>
<span style="color: #008000; font-weight: bold">using</span> <span style="color: #008000; font-weight: bold">namespace</span> arma;
<span style="color: #008000; font-weight: bold">using</span> <span style="color: #008000; font-weight: bold">namespace</span> std;

<span style="color: #B00040">int</span> <span style="color: #0000FF">main</span>(<span style="color: #B00040">int</span> argc, <span style="color: #B00040">char</span><span style="color: #666666">**</span> argv)
  {
  <span style="color: #408080; font-style: italic">// directly specify the matrix size (elements are uninitialised)</span>
  mat A(<span style="color: #666666">2</span>,<span style="color: #666666">3</span>);
  <span style="color: #408080; font-style: italic">// .n_rows = number of rows    (read only)</span>
  <span style="color: #408080; font-style: italic">// .n_cols = number of columns (read only)</span>
  cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;A.n_rows = &quot;</span> <span style="color: #666666">&lt;&lt;</span> A.n_rows <span style="color: #666666">&lt;&lt;</span> endl;
  cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;A.n_cols = &quot;</span> <span style="color: #666666">&lt;&lt;</span> A.n_cols <span style="color: #666666">&lt;&lt;</span> endl;
  <span style="color: #408080; font-style: italic">// directly access an element (indexing starts at 0)</span>
  A(<span style="color: #666666">1</span>,<span style="color: #666666">2</span>) <span style="color: #666666">=</span> <span style="color: #666666">456.0</span>;
  A.print(<span style="color: #BA2121">&quot;A:&quot;</span>);
  <span style="color: #408080; font-style: italic">// scalars are treated as a 1x1 matrix,</span>
  <span style="color: #408080; font-style: italic">// hence the code below will set A to have a size of 1x1</span>
  A <span style="color: #666666">=</span> <span style="color: #666666">5.0</span>;
  A.print(<span style="color: #BA2121">&quot;A:&quot;</span>);
  <span style="color: #408080; font-style: italic">// if you want a matrix with all elements set to a particular value</span>
  <span style="color: #408080; font-style: italic">// the .fill() member function can be used</span>
  A.set_size(<span style="color: #666666">3</span>,<span style="color: #666666">3</span>);
  A.fill(<span style="color: #666666">5.0</span>);  A.print(<span style="color: #BA2121">&quot;A:&quot;</span>);
</pre></div>
<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec37">Armadillo, simple examples </h2>

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">  mat B;

  <span style="color: #408080; font-style: italic">// endr indicates &quot;end of row&quot;</span>
  B <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.555950</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.274690</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.540605</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.798938</span> <span style="color: #666666">&lt;&lt;</span> endr
    <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.108929</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.830123</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.891726</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.895283</span> <span style="color: #666666">&lt;&lt;</span> endr
    <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.948014</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.973234</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.216504</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.883152</span> <span style="color: #666666">&lt;&lt;</span> endr
    <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.023787</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.675382</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.231751</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.450332</span> <span style="color: #666666">&lt;&lt;</span> endr;

  <span style="color: #408080; font-style: italic">// print to the cout stream</span>
  <span style="color: #408080; font-style: italic">// with an optional string before the contents of the matrix</span>
  B.print(<span style="color: #BA2121">&quot;B:&quot;</span>);

  <span style="color: #408080; font-style: italic">// the &lt;&lt; operator can also be used to print the matrix</span>
  <span style="color: #408080; font-style: italic">// to an arbitrary stream (cout in this case)</span>
  cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;B:&quot;</span> <span style="color: #666666">&lt;&lt;</span> endl <span style="color: #666666">&lt;&lt;</span> B <span style="color: #666666">&lt;&lt;</span> endl;
  <span style="color: #408080; font-style: italic">// save to disk</span>
  B.save(<span style="color: #BA2121">&quot;B.txt&quot;</span>, raw_ascii);
  <span style="color: #408080; font-style: italic">// load from disk</span>
  mat C;
  C.load(<span style="color: #BA2121">&quot;B.txt&quot;</span>);
  C <span style="color: #666666">+=</span> <span style="color: #666666">2.0</span> <span style="color: #666666">*</span> B;
  C.print(<span style="color: #BA2121">&quot;C:&quot;</span>);
</pre></div>
<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec38">Armadillo, simple examples </h2>

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">  <span style="color: #408080; font-style: italic">// submatrix types:</span>
  <span style="color: #408080; font-style: italic">//</span>
  <span style="color: #408080; font-style: italic">// .submat(first_row, first_column, last_row, last_column)</span>
  <span style="color: #408080; font-style: italic">// .row(row_number)</span>
  <span style="color: #408080; font-style: italic">// .col(column_number)</span>
  <span style="color: #408080; font-style: italic">// .cols(first_column, last_column)</span>
  <span style="color: #408080; font-style: italic">// .rows(first_row, last_row)</span>

  cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;C.submat(0,0,3,1) =&quot;</span> <span style="color: #666666">&lt;&lt;</span> endl;
  cout <span style="color: #666666">&lt;&lt;</span> C.submat(<span style="color: #666666">0</span>,<span style="color: #666666">0</span>,<span style="color: #666666">3</span>,<span style="color: #666666">1</span>) <span style="color: #666666">&lt;&lt;</span> endl;

  <span style="color: #408080; font-style: italic">// generate the identity matrix</span>
  mat D <span style="color: #666666">=</span> eye<span style="color: #666666">&lt;</span>mat<span style="color: #666666">&gt;</span>(<span style="color: #666666">4</span>,<span style="color: #666666">4</span>);

  D.submat(<span style="color: #666666">0</span>,<span style="color: #666666">0</span>,<span style="color: #666666">3</span>,<span style="color: #666666">1</span>) <span style="color: #666666">=</span> C.cols(<span style="color: #666666">1</span>,<span style="color: #666666">2</span>);
  D.print(<span style="color: #BA2121">&quot;D:&quot;</span>);

  <span style="color: #408080; font-style: italic">// transpose</span>
  cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;trans(B) =&quot;</span> <span style="color: #666666">&lt;&lt;</span> endl;
  cout <span style="color: #666666">&lt;&lt;</span> trans(B) <span style="color: #666666">&lt;&lt;</span> endl;

  <span style="color: #408080; font-style: italic">// maximum from each column (traverse along rows)</span>
  cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;max(B) =&quot;</span> <span style="color: #666666">&lt;&lt;</span> endl;
  cout <span style="color: #666666">&lt;&lt;</span> max(B) <span style="color: #666666">&lt;&lt;</span> endl;
</pre></div>
<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec39">Armadillo, simple examples </h2>

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">  <span style="color: #408080; font-style: italic">// maximum from each row (traverse along columns)</span>
  cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;max(B,1) =&quot;</span> <span style="color: #666666">&lt;&lt;</span> endl;
  cout <span style="color: #666666">&lt;&lt;</span> max(B,<span style="color: #666666">1</span>) <span style="color: #666666">&lt;&lt;</span> endl;
  <span style="color: #408080; font-style: italic">// maximum value in B</span>
  cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;max(max(B)) = &quot;</span> <span style="color: #666666">&lt;&lt;</span> max(max(B)) <span style="color: #666666">&lt;&lt;</span> endl;
  <span style="color: #408080; font-style: italic">// sum of each column (traverse along rows)</span>
  cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;sum(B) =&quot;</span> <span style="color: #666666">&lt;&lt;</span> endl;
  cout <span style="color: #666666">&lt;&lt;</span> sum(B) <span style="color: #666666">&lt;&lt;</span> endl;
  <span style="color: #408080; font-style: italic">// sum of each row (traverse along columns)</span>
  cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;sum(B,1) =&quot;</span> <span style="color: #666666">&lt;&lt;</span> endl;
  cout <span style="color: #666666">&lt;&lt;</span> sum(B,<span style="color: #666666">1</span>) <span style="color: #666666">&lt;&lt;</span> endl;
  <span style="color: #408080; font-style: italic">// sum of all elements</span>
  cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;sum(sum(B)) = &quot;</span> <span style="color: #666666">&lt;&lt;</span> sum(sum(B)) <span style="color: #666666">&lt;&lt;</span> endl;
  cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;accu(B)     = &quot;</span> <span style="color: #666666">&lt;&lt;</span> accu(B) <span style="color: #666666">&lt;&lt;</span> endl;
  <span style="color: #408080; font-style: italic">// trace = sum along diagonal</span>
  cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;trace(B)    = &quot;</span> <span style="color: #666666">&lt;&lt;</span> trace(B) <span style="color: #666666">&lt;&lt;</span> endl;
  <span style="color: #408080; font-style: italic">// random matrix -- values are uniformly distributed in the [0,1] interval</span>
  mat E <span style="color: #666666">=</span> randu<span style="color: #666666">&lt;</span>mat<span style="color: #666666">&gt;</span>(<span style="color: #666666">4</span>,<span style="color: #666666">4</span>);
  E.print(<span style="color: #BA2121">&quot;E:&quot;</span>);
</pre></div>
<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec40">Armadillo, simple examples </h2>

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">  <span style="color: #408080; font-style: italic">// row vectors are treated like a matrix with one row</span>
  rowvec r;
  r <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.59499</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.88807</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.88532</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.19968</span>;
  r.print(<span style="color: #BA2121">&quot;r:&quot;</span>);

  <span style="color: #408080; font-style: italic">// column vectors are treated like a matrix with one column</span>
  colvec q;
  q <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.81114</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.06256</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.95989</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.73628</span>;
  q.print(<span style="color: #BA2121">&quot;q:&quot;</span>);

  <span style="color: #408080; font-style: italic">// dot or inner product</span>
  cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;as_scalar(r*q) = &quot;</span> <span style="color: #666666">&lt;&lt;</span> as_scalar(r<span style="color: #666666">*</span>q) <span style="color: #666666">&lt;&lt;</span> endl;

    <span style="color: #408080; font-style: italic">// outer product</span>
  cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;q*r =&quot;</span> <span style="color: #666666">&lt;&lt;</span> endl;
  cout <span style="color: #666666">&lt;&lt;</span> q<span style="color: #666666">*</span>r <span style="color: #666666">&lt;&lt;</span> endl;


  <span style="color: #408080; font-style: italic">// sum of three matrices (no temporary matrices are created)</span>
  mat F <span style="color: #666666">=</span> B <span style="color: #666666">+</span> C <span style="color: #666666">+</span> D;
  F.print(<span style="color: #BA2121">&quot;F:&quot;</span>);

    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">0</span>;
</pre></div>
<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec41">Armadillo, simple examples </h2>

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #BC7A00">#include &lt;iostream&gt;</span>
<span style="color: #BC7A00">#include &quot;armadillo&quot;</span>
<span style="color: #008000; font-weight: bold">using</span> <span style="color: #008000; font-weight: bold">namespace</span> arma;
<span style="color: #008000; font-weight: bold">using</span> <span style="color: #008000; font-weight: bold">namespace</span> std;

<span style="color: #B00040">int</span> <span style="color: #0000FF">main</span>(<span style="color: #B00040">int</span> argc, <span style="color: #B00040">char</span><span style="color: #666666">**</span> argv)
  {
  cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;Armadillo version: &quot;</span> <span style="color: #666666">&lt;&lt;</span> arma_version<span style="color: #666666">::</span>as_string() <span style="color: #666666">&lt;&lt;</span> endl;

  mat A;

  A <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.165300</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.454037</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.995795</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.124098</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.047084</span> <span style="color: #666666">&lt;&lt;</span> endr
    <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.688782</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.036549</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.552848</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.937664</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.866401</span> <span style="color: #666666">&lt;&lt;</span> endr
    <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.348740</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.479388</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.506228</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.145673</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.491547</span> <span style="color: #666666">&lt;&lt;</span> endr
    <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.148678</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.682258</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.571154</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.874724</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.444632</span> <span style="color: #666666">&lt;&lt;</span> endr
    <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.245726</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.595218</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.409327</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.367827</span> <span style="color: #666666">&lt;&lt;</span> <span style="color: #666666">0.385736</span> <span style="color: #666666">&lt;&lt;</span> endr;

  A.print(<span style="color: #BA2121">&quot;A =&quot;</span>);

  <span style="color: #408080; font-style: italic">// determinant</span>
  cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;det(A) = &quot;</span> <span style="color: #666666">&lt;&lt;</span> det(A) <span style="color: #666666">&lt;&lt;</span> endl;
</pre></div>
<p>
<!-- !split --><br><br><br><br><br><br><br><br><br><br>

<h2 id="___sec42">Armadillo, simple examples </h2>

<p>

<!-- code=c++ (!bc cppcod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">  <span style="color: #408080; font-style: italic">// inverse</span>
  cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;inv(A) = &quot;</span> <span style="color: #666666">&lt;&lt;</span> endl <span style="color: #666666">&lt;&lt;</span> inv(A) <span style="color: #666666">&lt;&lt;</span> endl;
  <span style="color: #B00040">double</span> k <span style="color: #666666">=</span> <span style="color: #666666">1.23</span>;

  mat    B <span style="color: #666666">=</span> randu<span style="color: #666666">&lt;</span>mat<span style="color: #666666">&gt;</span>(<span style="color: #666666">5</span>,<span style="color: #666666">5</span>);
  mat    C <span style="color: #666666">=</span> randu<span style="color: #666666">&lt;</span>mat<span style="color: #666666">&gt;</span>(<span style="color: #666666">5</span>,<span style="color: #666666">5</span>);

  rowvec r <span style="color: #666666">=</span> randu<span style="color: #666666">&lt;</span>rowvec<span style="color: #666666">&gt;</span>(<span style="color: #666666">5</span>);
  colvec q <span style="color: #666666">=</span> randu<span style="color: #666666">&lt;</span>colvec<span style="color: #666666">&gt;</span>(<span style="color: #666666">5</span>);


  <span style="color: #408080; font-style: italic">// examples of some expressions</span>
  <span style="color: #408080; font-style: italic">// for which optimised implementations exist</span>
  <span style="color: #408080; font-style: italic">// optimised implementation of a trinary expression</span>
  <span style="color: #408080; font-style: italic">// that results in a scalar</span>
  cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;as_scalar( r*inv(diagmat(B))*q ) = &quot;</span>;
  cout <span style="color: #666666">&lt;&lt;</span> as_scalar( r<span style="color: #666666">*</span>inv(diagmat(B))<span style="color: #666666">*</span>q ) <span style="color: #666666">&lt;&lt;</span> endl;

  <span style="color: #408080; font-style: italic">// example of an expression which is optimised</span>
  <span style="color: #408080; font-style: italic">// as a call to the dgemm() function in BLAS:</span>
  cout <span style="color: #666666">&lt;&lt;</span> <span style="color: #BA2121">&quot;k*trans(B)*C = &quot;</span> <span style="color: #666666">&lt;&lt;</span> endl <span style="color: #666666">&lt;&lt;</span> k<span style="color: #666666">*</span>trans(B)<span style="color: #666666">*</span>C;

    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">0</span>;
</pre></div>
<p>

<!-- ------------------- end of main content --------------- -->


<center style="font-size:80%">
<!-- copyright --> &copy; 1999-2016, Morten Hjorth-Jensen. Released under CC Attribution-NonCommercial 4.0 license
</center>


</body>
</html>
    

